<script type="text/javascript">

    new Vue({
        el: '#search-typeahead',            
        props: ['post'],
        data: function() {
            return {
                searchTerms: '',
                searchResults: []
            };
        },
        computed: {
            hasResults: function () {
                return this.searchResults.length > 0;
            }
        },
        methods: {
            search: _.debounce(function () {
                self = this;
                if (self.searchTerms.length > 0) {
                    fetch('/api/forums/search/' + self.searchTerms)
                        .then(responseStream => responseStream.json())
                        .then(function (response) {
                            self.searchResults = [];
                            for (i = 0; i < response.data.length; i++) {
                                self.searchResults.push(response.data[i]);
                            }
                        })
                        .catch(error => console.log(error))
                }
                else {
                    self.searchResults = [];
                }
            }, 1000),
            onBlur: function () {
                if (this.searchTerms.length == 0) {
                    this.searchResults = [];
                }
            }
        },
        template:
            `@{await Html.RenderPartialAsync("Vue/TypeAheadTemplate");}`
    });
</script>